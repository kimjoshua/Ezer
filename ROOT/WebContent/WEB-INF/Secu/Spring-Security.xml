<beans:beans xmlns="http://www.springframework.org/schema/security"

	xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

	xsi:schemaLocation="http://www.springframework.org/schema/beans

           http://www.springframework.org/schema/beans/spring-beans-3.2.xsd

           http://www.springframework.org/schema/security

           http://www.springframework.org/schema/security/spring-security-3.2.xsd">


	<http pattern="*/**/*.js" security="none" />
	<http pattern="/**/*.css" security="none" />
	<http pattern="/img/*" security="none" />

	<http auto-config="true" use-expressions="true">

		<intercept-url pattern="/admin" access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/login" access="permitAll" />
		<intercept-url pattern="/**" access="permitAll" />
		<!-- <intercept-url pattern="/**" access="ROLE_USER,ROLE_ANONYMOUS,ROLE_ADMIN" 
			/> -->


		<form-login 
			username-parameter="loginid"
			password-parameter="loginpwd" 
			login-page="/login" 
			default-target-url="/login"
			authentication-success-handler-ref="customAuthenticationSuccessHandler"
			authentication-failure-handler-ref="customAuthenticationFailureHandler"
			/>
	
		<!-- enable csrf protection -->

	<!-- 	<csrf /> -->
<logout
	logout-success-url="/"
	delete-cookies="JSESSIONID"
/>
	</http>
	
	
	<beans:bean id="customAuthenticationSuccessHandler" class="com.secuTest.www.security.CustomAuthenticationSuccessHandler">
	
	<beans:property name="targetUrlParameter" value="loginRedirect"/>
	<beans:property name="useReferer" value="false"></beans:property>
	<beans:property name="defaultUrl" value="/" ></beans:property>
	
	</beans:bean>
<beans:bean id="custromAuthenticationFailureHandler" class="com.secuTest.www.security.CustomAuthenticationFailureHandler">

</beans:bean>

	<authentication-manager>
		<authentication-provider user-service-ref="CustomJdbcDaoImp" />
	</authentication-manager>
	<beans:bean id="CustomJdbcDaoImp" class="com.secuTest.www.dao.CustomJdbcDaoImp">
		<beans:property name="dataSource" ref="simpleDriverDataSource" />
		<beans:property name="rolePrefix" value="" />
		<beans:property name="usersByUsernameQuery"
			value="SELECT ID, PASSWORD,NAME FROM MEMBERINFO WHERE ID=?" />
			
			
	 	<beans:property name="authoritiesByUsernameQuery"
			value="SELECT * FROM MEM_Info WHERE ID=? "/>
		<beans:property name="enableGroups" value="false" />


	</beans:bean>


	<!-- <authentication-manager> <authentication-provider user-service-ref="memberService"/> 
		</authentication-manager> <beans:bean id="memberService" class="com.ezer_g.www.service.Ezer_Service_IMp"> 
		</beans:bean> -->



</beans:beans>